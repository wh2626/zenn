---
title: "Zodã§ãƒ•ã‚©ãƒ¼ãƒ ã«ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚’è¿½åŠ ã™ã‚‹"
emoji: "ğŸ˜¨"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["frontend", "React", "TypeScript", "reacthookform", "zod"]
published: false
publication_name: "spacemarket"
---

ã“ã‚“ã«ã¡ã¯ï¼
å…ˆæ—¥å¨˜ã¨ä¸€ç·’ã«ãƒ¡ã‚¶ã‚¹ã‚¿ã§å¿µé¡˜ã®UBã‚’ã‚³ãƒ³ãƒ—ã—ãŸwharaguchiã§ã™ï¼ğŸª¼ğŸƒğŸª¨

ä»Šå›ã¯ã€Zod + React Hook Formã«ã¤ã„ã¦ã®è¨˜äº‹ã«ãªã‚Šã¾ã™ã€‚

## å¯¾è±¡èª­è€…

- Zodã‚’è»½ãè§¦ã£ã¦ã¿ãŸã„æ–¹
- Zodã§ã©ã‚“ãªã“ã¨ãŒã§ãã‚‹ã‹çŸ¥ã‚ŠãŸã„æ–¹

## Zod is ä½•

å…¬å¼ã«ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«æ›¸ã‹ã‚Œã¦ã„ã¾ã™ã€‚ï¼ˆDeepLã«ã‚ˆã‚‹è¨³ï¼‰

> Zodã¯TypeScriptãƒ•ã‚¡ãƒ¼ã‚¹ãƒˆã®ã‚¹ã‚­ãƒ¼ãƒå®£è¨€ãƒ»æ¤œè¨¼ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã ã€‚
> Zodã¯å¯èƒ½ãªé™ã‚Šé–‹ç™ºè€…ã«å„ªã—ãè¨­è¨ˆã•ã‚Œã¦ã„ã‚‹ã€‚ã‚´ãƒ¼ãƒ«ã¯é‡è¤‡ã—ãŸå‹å®£è¨€ã‚’ãªãã™ã“ã¨ã ã€‚
> Zodã§ã¯ã€ãƒãƒªãƒ‡ãƒ¼ã‚¿ã‚’ä¸€åº¦å®£è¨€ã™ã‚Œã°ã€ZodãŒè‡ªå‹•çš„ã«é™çš„ãªTypeScriptã®å‹ã‚’æ¨è«–ã—ã¦ãã‚Œã‚‹ã€‚
> å˜ç´”ãªå‹ã‚’è¤‡é›‘ãªãƒ‡ãƒ¼ã‚¿æ§‹é€ ã«åˆæˆã™ã‚‹ã®ã‚‚ç°¡å˜ã ã€‚

ä»–ã«ã‚‚ã€ä¾å­˜é–¢ä¿‚ãŒã‚¼ãƒ­ã ã£ãŸã‚Šã€Node.jsã¨å…¨ã¦ã®ãƒ¢ãƒ€ãƒ³ãƒ–ãƒ©ã‚¦ã‚¶ã§å‹•ä½œã—ã€ãƒ—ãƒ¬ãƒ¼ãƒ³ãªJavaScriptã§ã‚‚å‹•ä½œã™ã‚‹ï¼ˆTypeScriptã‚’ä½¿ã†å¿…è¦ã¯ãªã„ï¼‰ã¨ã„ã£ãŸç‚¹ã‚‚ç‰¹å¾´ã¨ã—ã¦æŒ™ã’ã‚‰ã‚Œã¦ã„ã¾ã™ã€‚

https://zod.dev/?id=introduction

## ã‚„ã‚‹ã“ã¨

[å‰å›æ›¸ã„ãŸè¨˜äº‹](https://zenn.dev/spacemarket/articles/271cf9ec2513a7)ã®ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³å‡¦ç†ã«Zodã‚’ä½¿ç”¨ã—ã¦ã¿ã¾ã—ãŸã€‚

ãƒ•ã‚©ãƒ¼ãƒ ã®ä»•æ§˜ã¯å‰å›ã¨åŒæ§˜ä»¥ä¸‹ã«ãªã‚Šã¾ã™ã€‚

| é …ç›®     | å¿…é ˆ/ä»»æ„ | ãã®ä»–                                   |
| -------- | --------- | ---------------------------------------- |
| å§“       | å¿…é ˆ      | -                                        |
| å       | å¿…é ˆ      | -                                        |
| ã‚³ãƒ¡ãƒ³ãƒˆ | å¿…é ˆ      | æ–‡å­—æ•°åˆ¶é™ã‚ã‚Šï¼ˆ10æ–‡å­—ä»¥ä¸Šã€20æ–‡å­—ä»¥ä¸‹ï¼‰ |

## å®Ÿè£…

### å…ƒã¨ãªã‚‹ã‚³ãƒ¼ãƒ‰

å‰å›ã®è¨˜äº‹ã§React Hook Formã‚’ä½¿ç”¨ã—ãŸã‚µãƒ³ãƒ—ãƒ«ã¨ã—ã¦ä½œæˆã—ãŸãƒ•ã‚©ãƒ¼ãƒ ã‚’ä½¿ç”¨ã—ãŸã„ã¨æ€ã„ã¾ã™ã€‚

```tsx
import { FC } from "react";
import "./styles.css";

import { useForm, SubmitHandler } from "react-hook-form";

type Inputs = {
  firstName: string;
  lastName: string;
  comment: string;
  submit: any;
};

const App: FC = () => {
  const {
    register,
    handleSubmit,
    watch,
    formState: { errors },
  } = useForm<Inputs>();
  const onSubmit: SubmitHandler<Inputs> = (data) => console.log(data);

  // watch
  const lastName = watch("lastName");

  return (
    <div className="wrapper">
      <h1>React Form</h1>
      <section className="section">
        <h2>useState Form</h2>
        <p>React Hook Formã‚’ä½¿ç”¨ã—ã¦formã‚’ä½œæˆã—ãŸä¾‹ã§ã™ã€‚</p>
        <form onSubmit={handleSubmit(onSubmit)}>
          <div className="form-item">
            <label>
              <span className="label required">å¿…é ˆ</span>
              <span>å§“</span>
              <input
                type="text"
                {...register("lastName", {
                  required: "å§“ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„",
                })}
              />
            </label>
            {errors.lastName?.message && (
              <p className="error-message">{errors.lastName?.message}</p>
            )}
          </div>
          <div className="form-item">
            <label>
              <span className="label required">å¿…é ˆ</span>
              <span>å</span>
              <input
                type="text"
                {...register("firstName", {
                  required: "åã‚’å…¥åŠ›ã—ã¦ãã ã•ã„",
                })}
              />
            </label>
            {errors.firstName?.message && (
              <p className="error-message">{errors.firstName?.message}</p>
            )}
          </div>
          <div className="form-item">
            <label>
              <span className="label required">å¿…é ˆ</span>
              <span>ã‚³ãƒ¡ãƒ³ãƒˆ</span>
              <textarea
                {...register("comment", {
                  required: true,
                  minLength: {
                    value: 10,
                    message: "10æ–‡å­—ä»¥ä¸Šã§å…¥åŠ›ã—ã¦ãã ã•ã„",
                  },
                  maxLength: {
                    value: 20,
                    message: "20æ–‡å­—ä»¥ä¸‹ã§å…¥åŠ›ã—ã¦ãã ã•ã„",
                  },
                })}
              />
            </label>
            {errors.comment?.message && (
              <p className="error-message">{errors.comment.message}</p>
            )}
          </div>
          <div className="submit-button">
            <input type="submit" />
          </div>
        </form>
      </section>
      <p>å§“: {lastName}</p>
    </div>
  );
};
```

### å®Œæˆã‚³ãƒ¼ãƒ‰

ä»¥ä¸‹ãŒå®Œæˆã—ãŸã‚³ãƒ¼ãƒ‰ã«ãªã‚Šã¾ã™ã€‚
CodeSandboxã‚‚ç”¨æ„ã—ã¾ã—ãŸã€‚
https://codesandbox.io/s/react-hook-form-zod-w22trj?file=/src/App.tsx

### è§£èª¬

ä¸»ãªå¤‰æ›´ç‚¹ã¯ã€ã‚¿ã‚¤ãƒˆãƒ«ã®é€šã‚ŠZodã‚’ä½¿ç”¨ã—ãŸãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ«ãƒ¼ãƒ«ã®å®šç¾©ã¨ã‚¹ã‚­ãƒ¼ãƒã®å®šç¾©ã€ã‚¹ã‚­ãƒ¼ãƒã‹ã‚‰å‹æƒ…å ±ã‚’ç”Ÿæˆã—ãŸç‚¹ã«ãªã‚Šã¾ã™ã€‚

å…·ä½“çš„ã«è¦‹ã¦ã„ãã¾ã™ã€‚

#### 1. ã‚¹ã‚­ãƒ¼ãƒã®ä½œæˆ

ä»Šå›ã¯types.tsãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ã€ã¾ãšã‚¹ã‚­ãƒ¼ãƒã‚’å®šç¾©ã—ã¾ã—ãŸã€‚

```diff ts:types.ts
+ import { z } from "zod";
+ export const inputs = z.object({
+   firstName: z.string(),
+   lastName: z.string(),
+   comment: z.string(),
+   submit: z.any()
+ });
```

ã‚¹ã‚­ãƒ¼ãƒå®šç¾©ã«ã¤ã„ã¦ã¯ã€ä»¥ä¸‹ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã«ã¾ã¨ã¾ã£ã¦ã„ã¾ã™ã®ã§ã€ã¾ãšã¯ã“ã¡ã‚‰ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã«ç›®ã‚’é€šã™ã¨ã„ã„ã¨æ€ã„ã¾ã™ã€‚
https://github.com/colinhacks/zod#basic-usage

#### 2. ã‚¹ã‚­ãƒ¼ãƒã‹ã‚‰å‹ã‚’ç”Ÿæˆ

`z.infer`ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã§ã‚¹ã‚­ãƒ¼ãƒã‹ã‚‰å‹æƒ…å ±ã‚’ç”Ÿæˆã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

```ts:types.ts
 import { z } from "zod";
 export const inputs = z.object({
   firstName: z.string(),
   lastName: z.string(),
   comment: z.string(),
   submit: z.any()
 });
export type InputsType = z.infer<typeof inputs>;
// type InputsType = {
//   firstName: string;
//   lastName: string;
//   comment: string;
//   submit?: any;
// }
```

å…ƒã®ã‚³ãƒ¼ãƒ‰ã§App.tsxå†…ã§å®šç¾©ã—ã¦ã„ãŸ`Inputs`ã‚’å‰Šé™¤ã—ã€æ–°ãŸã«å®šç¾©ã—ãŸ`InputsType`ã‚’é©ç”¨ã—ã¾ã™ã€‚

##### before

```diff tsx:App.tsx
- type Inputs = {
-   firstName: string;
-   lastName: string;
-   comment: string;
-   submit: any;
- };

const {
  register,
  handleSubmit,
  watch,
  formState: { errors },
- } = useForm<Inputs>();
```

##### after

```diff tsx:App.tsx
+ import { InputsType } from "./types";
const {
  register,
  handleSubmit,
  watch,
  formState: { errors }
+ } = useForm<InputsType>();
```

#### 3. Resolverã®å®šç¾©

useFormã®å¼•æ•°ã«resolverã‚’å®šç¾©ã™ã‚‹ã“ã¨ã§ã€ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ«ãƒ¼ãƒ«ã‚’å®šç¾©ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚
ä»Šå›ã¯Zodã‚’ä½¿ç”¨ã™ã‚‹ã®ã§ã€`zodResolver`ã¨ã„ã†ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã§ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ«ãƒ¼ãƒ«ã‚’å®šç¾©ã—ã¾ã—ãŸã€‚

https://github.com/react-hook-form/resolvers#zod

`zodResolver`ã®å¼•æ•°ã«1ã§å®šç¾©ã—ãŸã‚¹ã‚­ãƒ¼ãƒã‚’æ¸¡ã™ã“ã¨ã§ã€ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ«ãƒ¼ãƒ«ã‚’å®šç¾©ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

```diff tsx:App.tsx
+ import { InputsType, inputs } from "./types";
+ import { zodResolver } from "@hookform/resolvers/zod";
const {
  register,
  handleSubmit,
  watch,
  formState: { errors }
 } = useForm<InputsType>({
+  resolver: zodResolver(inputs)
  });
```

#### 4. ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ«ãƒ¼ãƒ«ã®ä½œæˆ

æœ€å¾Œã«ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ«ãƒ¼ãƒ«ã‚’types.tsã«æ›¸ã„ã¦ã„ãã¾ã™ã€‚
ä»Šå›ã®ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ«ãƒ¼ãƒ«ã¯ä»¥ä¸‹ã«ãªã£ã¦ã„ã¾ã™ã€‚

| é …ç›®     | å¿…é ˆ/ä»»æ„ | ãã®ä»–                                   |
| -------- | --------- | ---------------------------------------- |
| å§“       | å¿…é ˆ      | -                                        |
| å       | å¿…é ˆ      | -                                        |
| ã‚³ãƒ¡ãƒ³ãƒˆ | å¿…é ˆ      | æ–‡å­—æ•°åˆ¶é™ã‚ã‚Šï¼ˆ10æ–‡å­—ä»¥ä¸Šã€20æ–‡å­—ä»¥ä¸‹ï¼‰ |

```diff ts:types.ts
import { z } from "zod";
export const inputs = z.object({
+   firstName: z.string().min(1, {
+     message: "å¿…é ˆé …ç›®ã§ã™ã€‚"
+   }),
+   lastName: z.string().min(1, {
+     message: "å¿…é ˆé …ç›®ã§ã™ã€‚"
+   }),
+   comment: z
+     .string()
+     .min(10, {
+       message: "10æ–‡å­—ä»¥ä¸Šã§å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚"
+     })
+     .max(20, {
+       message: "20æ–‡å­—ä»¥ä¸‹ã§å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚"
+     }),
   submit: z.any()
});
export type InputsType = z.infer<typeof inputs>;
```

å„é …ç›®ãŒå¿…é ˆé …ç›®ã«ãªã£ã¦ã„ã‚‹ãŸã‚ã€å…¨ã¦ã®å®šç¾©ã«å¯¾ã—`min`ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚
ç¬¬ä¸€å¼•æ•°ã«æœ€ä½å…¥åŠ›æ–‡å­—æ•°ã‚’å…¥ã‚Œã‚‹ã“ã¨ãŒã§ãã€æ¡ä»¶ã«é”ã—ã¦ã„ãªã„å ´åˆã®ã‚¨ãƒ©ãƒ¼æ–‡ã¯ã€`message`ã§å®šç¾©ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

ãªãŠã€`message`ã‚’å®šç¾©ã—ãªã„ã¨ä»¥ä¸‹ã®ã‚ˆã†ã«è‹±èªã§ã‚¨ãƒ©ãƒ¼ãŒè¡¨ç¤ºã•ã‚Œã¦ã—ã¾ã†ãŸã‚ã€æŒ‡å®šã®ã‚¨ãƒ©ãƒ¼æ–‡ãŒã‚ã‚‹å ´åˆã«ã¯ã“ã“ã§å®šç¾©ã™ã‚‹ã‚ˆã†ã«ã—ã¾ã—ã‚‡ã†ã€‚

![](/images/1ff2d4b77141b2/error-sample.png)

ä»¥ä¸ŠãŒZodã§ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚’è¿½åŠ ã™ã‚‹æ–¹æ³•ã«ãªã‚Šã¾ã™ã€‚
æœ€çµ‚çš„ãªã‚³ãƒ¼ãƒ‰ã¯ä»¥ä¸‹ã§ã™ã€‚

## æœ€çµ‚çš„ãªã‚³ãƒ¼ãƒ‰

```tsx:App.tsx
import { FC } from "react";
import "./styles.css";
import { InputsType, inputs } from "./types";
import { zodResolver } from "@hookform/resolvers/zod";

import {
  useForm,
  SubmitHandler
} from "react-hook-form";

const App: FC = () => {
  const {
    register,
    handleSubmit,
    watch,
    formState: { errors }
  } = useForm<InputsType>({
    resolver: zodResolver(inputs)
  });
  const onSubmit: SubmitHandler<InputsType> = (
    data
  ) => console.log(data);

  console.log("errors", errors);

  // watch
  const lastName = watch("lastName");

  return (
    <div className="wrapper">
      <h1>React Form</h1>
      <section className="section">
        <h2>React Hook Form + Zod</h2>
        <p>
          React Hook Form ã¨
          Zodã‚’ä½¿ç”¨ã—ã¦formã‚’ä½œæˆã—ãŸä¾‹ã§ã™ã€‚
        </p>
        <form onSubmit={handleSubmit(onSubmit)}>
          <div className="form-item">
            <label>
              <span className="label required">
                å¿…é ˆ
              </span>
              <span>å§“</span>
              <input
                type="text"
                {...register("lastName")}
              />
            </label>
            {errors.lastName?.message && (
              <p className="error-message">
                {errors.lastName?.message}
              </p>
            )}
          </div>
          <div className="form-item">
            <label>
              <span className="label required">
                å¿…é ˆ
              </span>
              <span>å</span>
              <input
                type="text"
                {...register("firstName")}
              />
            </label>
            {errors.firstName?.message && (
              <p className="error-message">
                {errors.firstName?.message}
              </p>
            )}
          </div>
          <div className="form-item">
            <label>
              <span className="label required">
                å¿…é ˆ
              </span>
              <span>ã‚³ãƒ¡ãƒ³ãƒˆ</span>
              <textarea
                {...register("comment")}
              />
            </label>
            {errors.comment?.message && (
              <p className="error-message">
                {errors.comment.message}
              </p>
            )}
          </div>
          <div className="submit-button">
            <input type="submit" />
          </div>
        </form>
      </section>
      <p>å§“: {lastName}</p>
    </div>
  );
};
export default App;
```

```ts:types.ts
import { z } from "zod";

export const inputs = z.object({
  firstName: z.string().min(1, {
    message: "å¿…é ˆé …ç›®ã§ã™ã€‚"
  }),
  lastName: z.string().min(1, {
    message: "å¿…é ˆé …ç›®ã§ã™ã€‚"
  }),
  comment: z
    .string()
    .min(10, {
      message: "10æ–‡å­—ä»¥ä¸Šã§å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚"
    })
    .max(20, {
      message: "20æ–‡å­—ä»¥ä¸‹ã§å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚"
    }),
  submit: z.any()
});
export type InputsType = z.infer<typeof inputs>;
```

## æœ€å¾Œã«

ä»Šå›ã¯åŸºæœ¬çš„ãªéƒ¨åˆ†ã«è§¦ã‚Œã‚‹ã®ã¿ã§ã—ãŸãŒã€ã„ã‹ãŒã§ã—ãŸã§ã—ã‚‡ã†ã‹ï¼Ÿ

å€‹äººçš„ã«ã¯Zodã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã§ã€ãƒ­ã‚¸ãƒƒã‚¯ã‹ã‚‰ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ«ãƒ¼ãƒ«ã‚’åˆ†é›¢ã§ããŸã“ã¨ãŒå¤§ãã„ã¨æ„Ÿã˜ã¾ã—ãŸã€‚
ã‚ˆã‚Šé …ç›®æ•°ãŒå¤šã„ãƒ•ã‚©ãƒ¼ãƒ ãªã©ã§ã¯ã€åˆ†é›¢ã•ã‚Œã¦ã„ãªã„ã¨å¯èª­æ€§ãŒä½ããªã‚Šã€é–‹ç™ºã«ã¤ã‚‰ã¿ãŒå‡ºã¦ãã‚‹ã¨æ€ã„ã¾ã™ã®ã§ã€ãã†ã„ã£ãŸæ„å‘³ã§ã‚‚Zodã«ã™ã‚‹ãƒ¡ãƒªãƒƒãƒˆãŒã‚ã‚‹ã¨æ„Ÿã˜ã¾ã—ãŸã€‚

ä»Šå›ã¯ä»¥ä¸Šã¨ãªã‚Šã¾ã™ã€‚
æœ€å¾Œã¾ã§èª­ã‚“ã§ã„ãŸã ãã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã—ãŸï¼
